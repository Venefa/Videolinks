# Create Debian-Container "Docker" in Hypervisor/Proxmox
# It got the CT ID 104
# 8GB RAM
# 4 Cores
# 20GB Storage

#----------- On Proxmox-----------#
# in  terminal:
# edit Container Config on Hypervisor:
nano /etc/pve/lxc/104.conf
# Add lines:
lxc.cgroup.devices.allow: c 10:200 rwm
lxc.mount.entry: /dev/net dev/net none bind,create=dir

#----------- On created Debian Container -----------#
# Update, Upgrade, cleanup, install docker.io
apt update && apt upgrade -y && apt autoremove -y && apt install curl docker.io -y

# Set Timezone
dpkg-reconfigure tzdata

# Download Docker-Compose to /usr/local/bin/docker-compose
curl -L https://github.com/docker/compose/releases/download/v$(curl -Ls https://www.servercow.de/docker-compose/latest.php)/docker-compose-$(uname -s)-$(uname -m) > /usr/local/bin/docker-compose

# grant execute permission for /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

# create and run portainer container on Port 9443
docker run -d -p 9443:9443 --name portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latest
